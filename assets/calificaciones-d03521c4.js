import{a as b}from"./auth-b795a22c.js";import{f as g,Q as p,T as E,j as h,h as v,r as w,O as y,A as c,K as T,G as D,$ as d,D as S,o as N,s as m}from"./trimestres-e1fc16a8.js";const r=g(),L=t=>{p(E(r,"notas"),t)},k=async t=>{h(v(E(r,"notas"),w("user","==",b().id)),s=>{const o=[];s.forEach(e=>{o.push({...e.data(),id:e.id})}),t(o)})},A=async t=>{const s=await y(c(r,"notas",t));return{...s.data(),id:s.id}},B=async(t,s)=>{await T(c(r,"notas",t),s)},C=async t=>{await D(c(r,"notas",t))};let u=!1,I=t=>{u=t},l="",O=t=>{l=t};const f=t=>{$("#lista").DataTable({responsive:{details:{renderer:$.fn.dataTable.Responsive.renderer.listHiddenNodes()}},language:{url:"//cdn.datatables.net/plug-ins/1.10.21/i18n/Spanish.json"},data:t,drawCallback:function(){document.querySelectorAll(".eliminar").forEach(e=>{e.addEventListener("click",async()=>{const a=e.dataset.id;swal({title:"¿Está seguro de eliminar?",text:"Si elimina una calificacion no podrá recuperarla!",icon:"warning",buttons:["No, cancelar","Si, eliminar"],dangerMode:!0}).then(async i=>{i&&(await C(a),swal("Eliminado!","La nota se ha borrado!","success"))})})}),document.querySelectorAll(".editar").forEach(e=>{e.addEventListener("click",async()=>{u=!0,l=e.dataset.id;try{const a=await A(l);formulario.trimestre.value=a.trimestre,formulario.profesor.value=a.profesor,formulario.asignatura.value=a.asignatura,formulario.nota.value=a.nota}catch(a){console.log(a)}})})}})};window.$=d;window.DataTable=S;const n=document.getElementById("formulario");let j=document.getElementById("guardar");document.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("trimestre"),s=[];await N(o=>{o.forEach(e=>{const a=document.createElement("option");a.value=e.id,a.textContent=e.nombre,t.appendChild(a),s[e.id]=e.nombre})}),await k(o=>{let e=[];o.forEach(a=>{e.push([s[a.trimestre],a.profesor,a.asignatura,a.nota,`<div class="tareas">
                                 <button data-id="${a.id}" class="editar">Editar</button>
                                 <button data-id="${a.id}" class="eliminar">Eliminar</button>
                             </div>`])}),d.fn.DataTable.isDataTable("#lista")&&d("#lista").DataTable().destroy(),f(e)})});j.addEventListener("click",()=>{const t=n.trimestre.value,s=n.profesor.value,o=n.asignatura.value,e=n.nota.value;if(t===""||s===""||o===""||e===""){m({title:"Error!",text:"Todos los campos son obligatorios!",icon:"warning",button:"Ok!"});return}let a=b().id;const i={trimestre:t,profesor:s,asignatura:o,nota:e,user:a};u?(B(l,i),I(!1),O("")):L(i),m("Bien hecho!","Sus datos se han registrado!","success"),n.reset()});
